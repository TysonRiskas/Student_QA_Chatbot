<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INFO 6200 Student Q&A Chatbot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div id="safari-warning" style="display:none; padding: 1em; background-color: #ffecb3; color: #664d03; border: 1px solid #ffc107; border-radius: 5px; margin: 1em 0;">
        <strong>Safari Users:</strong> For the chatbot to function correctly, please uncheck "Prevent cross-site tracking" in Safari's privacy settings.
    </div>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="robot-icon">ğŸ¤–</div>
                <h1>INFO 6200 Q&A Assistant</h1>
                <p class="subtitle">Your AI Teaching Assistant for Python Coding</p>
                {% if user_info and user_info.get('is_registered') %}
                <p class="user-greeting">Welcome back, {{ user_info.firstName }}! ğŸ‘‹</p>
                {% endif %}
            </div>
            <div class="header-actions">
                <a href="/logout" class="header-button">ğŸšª Logout</a>
            </div>
        </header>

        <div class="chat-container">
            <div id="chatMessages" class="chat-messages">
                <div class="message bot-message">
                    <div class="message-icon">ğŸ¤–ğŸ“</div>
                    <div class="message-content">
                        {% if user_info and user_info.get('is_registered') %}
                        <p>Hello {{ user_info.firstName }}! I'm your AI teaching assistant for INFO 6200. I'm here to help you with Python coding questions. What would you like to learn about today?</p>
                        {% else %}
                        <p>Hello! I'm your AI teaching assistant for INFO 6200. Ask me any questions about Python coding and course content!</p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="input-container">
                <div class="button-row">
                    {% if user_info and user_info.get('is_registered') %}
                    <button type="button" id="historyButton" class="action-button">
                        ğŸ“š My Chat History
                    </button>
                    {% endif %}
                    <button type="button" id="clearChatButton" class="action-button">
                        ğŸ—‘ï¸ Clear Chat
                    </button>
                </div>
                <form id="chatForm">
                    <input 
                        type="text" 
                        id="questionInput" 
                        placeholder="Type your question here..." 
                        autocomplete="off"
                        required
                    >
                    <button type="submit" id="sendButton">Send</button>
                </form>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
            if (isSafari) {
                document.getElementById('safari-warning').style.display = 'block';
            }
        });
    </script>
</body>
</html>
